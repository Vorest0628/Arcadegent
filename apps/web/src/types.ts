export type RegionItem = {
  code: string;
  name: string;
};

export type ArcadeSummary = {
  source: string;
  source_id: number;
  source_url: string;
  name: string;
  name_pinyin?: string | null;
  address?: string | null;
  transport?: string | null;
  province_code?: string | null;
  province_name?: string | null;
  city_code?: string | null;
  city_name?: string | null;
  county_code?: string | null;
  county_name?: string | null;
  status?: string | number | null;
  type?: string | number | null;
  pay_type?: string | number | null;
  locked?: string | number | null;
  ea_status?: string | number | null;
  price?: string | number | null;
  start_time?: string | number | null;
  end_time?: string | number | null;
  fav_count?: number | null;
  updated_at?: string | null;
  arcade_count: number;
};

export type ArcadeTitle = {
  id?: number | null;
  title_id?: string | number | null;
  title_name?: string | null;
  quantity?: number | null;
  version?: string | null;
  coin?: string | number | null;
  eacoin?: string | number | null;
  comment?: string | null;
};

export type ArcadeDetail = ArcadeSummary & {
  comment?: string | null;
  url?: string | null;
  image_thumb?: Record<string, unknown> | null;
  events: Array<Record<string, unknown>>;
  arcades: ArcadeTitle[];
  collab?: boolean | null;
};

export type PagedArcades = {
  items: ArcadeSummary[];
  page: number;
  page_size: number;
  total: number;
  total_pages: number;
};

export type IntentType = "search" | "search_nearby" | "navigate";

export type ChatRequest = {
  session_id?: string;
  message: string;
  intent?: IntentType;
  shop_id?: number;
  keyword?: string;
  province_code?: string;
  city_code?: string;
  county_code?: string;
  page_size?: number;
};

export type RouteSummary = {
  provider: "amap" | "google" | "none";
  mode: string;
  distance_m?: number | null;
  duration_s?: number | null;
  polyline: Array<{ lng: number; lat: number }>;
  hint?: string | null;
};

export type ChatResponse = {
  session_id: string;
  intent: IntentType;
  reply: string;
  shops: ArcadeSummary[];
  route?: RouteSummary | null;
};

export type ChatHistoryTurn = {
  role: "user" | "assistant" | "tool";
  content: string;
  name?: string | null;
  call_id?: string | null;
  created_at: string;
};

export type ChatSessionSummary = {
  session_id: string;
  title: string;
  preview?: string | null;
  intent: IntentType;
  turn_count: number;
  created_at: string;
  updated_at: string;
};

export type ChatSessionDetail = {
  session_id: string;
  intent: IntentType;
  active_subagent: string;
  turn_count: number;
  created_at: string;
  updated_at: string;
  turns: ChatHistoryTurn[];
};

export type ChatStreamEventName =
  | "session.started"
  | "subagent.changed"
  | "assistant.token"
  | "tool.started"
  | "tool.progress"
  | "tool.completed"
  | "tool.failed"
  | "navigation.route_ready"
  | "assistant.completed"
  | "session.failed";

export type ChatStreamEnvelope = {
  id: number;
  session_id: string;
  event: ChatStreamEventName;
  at: string;
  data: Record<string, unknown>;
};
